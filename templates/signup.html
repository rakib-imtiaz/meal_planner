{% extends "layout.html" %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-green-400 to-teal-500 relative overflow-hidden">
    <!-- Background Animation with Floating Emojis -->
    <div class="absolute inset-0 z-0">
        <canvas id="backgroundCanvas" class="w-full h-full"></canvas>
    </div>
    
    <!-- Signup Card -->
    <div class="max-w-md w-full bg-white bg-opacity-80 backdrop-filter backdrop-blur-md p-8 rounded-3xl shadow-2xl transform hover:scale-105 transition-all duration-300 ease-in-out relative z-10 animate__animated animate__fadeIn">
        <h2 class="text-4xl font-extrabold mb-6 text-center text-gray-800 animate__animated animate__fadeInDown">
            <i class="fas fa-user-plus text-green-600"></i> Sign Up
        </h2>
        <form action="/signup" method="post" class="space-y-6">
            <!-- Username Field -->
            <div class="relative">
                <input type="text" id="username" name="username" required class="peer w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500 transition-all duration-300 placeholder-transparent bg-transparent text-gray-800">
                <label for="username" class="absolute left-4 -top-5 text-gray-600 text-sm transition-all duration-300 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-5 peer-focus:text-green-500 peer-focus:text-sm">Username</label>
            </div>
            <!-- Email Field -->
            <div class="relative">
                <input type="email" id="email" name="email" required class="peer w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500 transition-all duration-300 placeholder-transparent bg-transparent text-gray-800">
                <label for="email" class="absolute left-4 -top-5 text-gray-600 text-sm transition-all duration-300 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-5 peer-focus:text-green-500 peer-focus:text-sm">Email</label>
            </div>
            <!-- Password Field -->
            <div class="relative">
                <input type="password" id="password" name="password" required class="peer w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500 transition-all duration-300 placeholder-transparent bg-transparent text-gray-800">
                <label for="password" class="absolute left-4 -top-5 text-gray-600 text-sm transition-all duration-300 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-3 peer-focus:-top-5 peer-focus:text-green-500 peer-focus:text-sm">Password</label>
            </div>
            <!-- Submit Button -->
            <button type="submit" class="w-full bg-gradient-to-r from-green-500 to-teal-500 text-white py-3 rounded-lg hover:from-green-600 hover:to-teal-600 transform hover:-translate-y-1 transition-all duration-300 shadow-lg animate__animated animate__pulse animate__infinite">
                <i class="fas fa-user-plus mr-2"></i> Sign Up
            </button>
        </form>
        <!-- Additional Links -->
        <div class="mt-6 text-center">
            <p class="text-gray-700">Already have an account? <a href="{{ url_for('login') }}" class="text-green-600 font-bold hover:underline">Login</a></p>
        </div>
    </div>
</div>

<!-- Include Font Awesome for Icons -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

<!-- Three.js for Background Animation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
    // Background Animation with Floating Emojis
    const canvas = document.getElementById('backgroundCanvas');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 500);
    camera.position.set(0, 0, 100);

    const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(window.devicePixelRatio);

    // Array of meal-related emojis
    const mealEmojis = [
        '🍔', '🍕', '🍎', '🍌', '🍰', '🍣', '🍩', '🍪', '🍇', '🍉',
        '🍓', '🥑', '🌽', '🥕', '🌮', '🍗', '🍖', '🍤', '🍿', '🍹'
    ];

    // Create floating emoji particles
    const particles = [];
    const particleCount = 50;

    for (let i = 0; i < particleCount; i++) {
        const size = Math.random() * 4 + 9; // Random size between 9 and 13
        const geometry = new THREE.PlaneGeometry(size, size);
        const mealEmoji = mealEmojis[Math.floor(Math.random() * mealEmojis.length)];
        const canvasTexture = createEmojiTexture(mealEmoji);
        const material = new THREE.MeshBasicMaterial({
            map: canvasTexture,
            transparent: true
        });
        const particle = new THREE.Mesh(geometry, material);

        // Random position within the visible area
        particle.position.set(
            (Math.random() - 0.5) * window.innerWidth * 0.2,
            (Math.random() - 0.5) * window.innerHeight * 0.2,
            0
        );

        // Random speed
        particle.userData.velocity = new THREE.Vector3(
            (Math.random() - 0.5) * 0.05,
            (Math.random() - 0.2) * 0.05,
            0
        );

        scene.add(particle);
        particles.push(particle);
    }

    function animate() {
        requestAnimationFrame(animate);

        particles.forEach(particle => {
            particle.position.add(particle.userData.velocity);

            // Wrap around logic based on window size
            if (particle.position.x > window.innerWidth / 10) particle.position.x = -window.innerWidth / 10;
            if (particle.position.x < -window.innerWidth / 10) particle.position.x = window.innerWidth / 10;
            if (particle.position.y > window.innerHeight / 10) particle.position.y = -window.innerHeight / 10;
            if (particle.position.y < -window.innerHeight / 10) particle.position.y = window.innerHeight / 10;
        });

        renderer.render(scene, camera);
    }
    animate();

    // Function to create a texture from an emoji
    function createEmojiTexture(emoji) {
        const canvasSize = 128;
        const canvas = document.createElement('canvas');
        canvas.width = canvasSize;
        canvas.height = canvasSize;

        const ctx = canvas.getContext('2d');
        ctx.font = `${canvasSize * 0.8}px sans-serif`;
        ctx.fillStyle = '#ffffff';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(emoji, canvasSize / 2, canvasSize / 2);

        const texture = new THREE.CanvasTexture(canvas);
        return texture;
    }

    // Handle window resize
    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>

<!-- Anime.js for Element Animations -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        anime.timeline()
            .add({
                targets: '.animate__fadeIn',
                opacity: [0, 1],
                easing: 'easeOutQuad',
                duration: 800
            })
            .add({
                targets: 'input, button',
                translateY: [50, 0],
                opacity: [0, 1],
                delay: anime.stagger(100),
                easing: 'easeOutExpo'
            }, '-=600');
    });
</script>
{% endblock %}
