{% extends "layout.html" %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-green-400 to-teal-500 relative overflow-hidden">
    <!-- Background Animation with Floating Emojis -->
    <div class="absolute inset-0 z-0 backdrop-filter backdrop-blur-sm">
        <canvas id="backgroundCanvas" class="w-full h-full"></canvas>
    </div>

    <!-- Main Content -->
    <div class="text-center p-12 bg-gray-800 bg-opacity-80 backdrop-filter backdrop-blur-md rounded-3xl shadow-2xl transform hover:scale-105 transition-all duration-300 ease-in-out relative z-10 max-w-2xl w-full">
        <!-- Icon -->
        <div class="flex justify-center mb-8">
            <span class="text-green-400 text-7xl animate__animated animate__bounceIn">
                🍽️
            </span>
        </div>
        <h1 class="text-5xl font-extrabold mb-6 text-white animate__animated animate__fadeInDown">
            Welcome to <span class="text-green-400">MealMate</span>
        </h1>
        <p class="text-xl mb-10 text-gray-300 animate__animated animate__fadeInUp animate__delay-1s">
            Your personal meal recommendation assistant
        </p>
        <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6">
            <a href="/login" class="inline-block bg-green-500 text-white font-bold py-3 px-10 rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 ease-in-out animate__animated animate__bounceIn animate__delay-2s">
                <i class="fas fa-sign-in-alt mr-2"></i> Login
            </a>
            <a href="/signup" class="inline-block bg-teal-500 text-white font-bold py-3 px-10 rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 ease-in-out animate__animated animate__bounceIn animate__delay-2s">
                <i class="fas fa-user-plus mr-2"></i> Sign Up
            </a>
        </div>
    </div>
</div>

<!-- Include Font Awesome for Icons -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

<!-- Three.js for Background Animation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
    // Background Animation with Floating Emojis
    const canvas = document.getElementById('backgroundCanvas');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 500);
    camera.position.set(0, 0, 100);

    const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(window.devicePixelRatio);

    // Array of meal-related emojis
    const mealEmojis = [
        '🍔', '🍕', '🍎', '🍌', '🍰', '🍣', '🍩', '🍪', '🍇', '🍉',
        '🍓', '🥑', '🌽', '🥕', '🌮', '🍗', '🍖', '🍤', '🍿', '🍹'
    ];

    // Create floating emoji particles
    const particles = [];
    const particleCount = 50;

    for (let i = 0; i < particleCount; i++) {
        const size = Math.random() * 2 + 7; // Random size between 10 and 20
        const geometry = new THREE.PlaneGeometry(size, size);
        const mealEmoji = mealEmojis[Math.floor(Math.random() * mealEmojis.length)];
        const canvasTexture = createEmojiTexture(mealEmoji, size);
        const material = new THREE.MeshBasicMaterial({
            map: canvasTexture,
            transparent: true
        });
        const particle = new THREE.Mesh(geometry, material);

        // Random position within the visible area
        particle.position.set(
            (Math.random() - 0.5) * window.innerWidth * 0.1,
            (Math.random() - 0.5) * window.innerHeight * 0.1,
            0
        );

        // Random speed
        particle.userData.velocity = new THREE.Vector3(
            (Math.random() - 0.5) * 0.1,
            (Math.random() - 0.2) * 0.1,
            0
        );

        scene.add(particle);
        particles.push(particle);
    }

    function animate() {
        requestAnimationFrame(animate);

        particles.forEach(particle => {
            particle.position.add(particle.userData.velocity);

            // Wrap around logic based on window size
            if (particle.position.x > window.innerWidth / 10) particle.position.x = -window.innerWidth / 10;
            if (particle.position.x < -window.innerWidth / 10) particle.position.x = window.innerWidth / 10;
            if (particle.position.y > window.innerHeight / 10) particle.position.y = -window.innerHeight / 10;
            if (particle.position.y < -window.innerHeight / 10) particle.position.y = window.innerHeight / 10;
        });

        renderer.render(scene, camera);
    }
    animate();

    // Function to create a texture from an emoji
    function createEmojiTexture(emoji, size) {
        const canvasSize = 128;
        const canvas = document.createElement('canvas');
        canvas.width = canvasSize;
        canvas.height = canvasSize;

        const ctx = canvas.getContext('2d');
        ctx.font = `${canvasSize * 0.8}px sans-serif`;
        ctx.fillStyle = '#ffffff';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(emoji, canvasSize / 2, canvasSize / 2);

        const texture = new THREE.CanvasTexture(canvas);
        return texture;
    }

    // Handle window resize
    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>
{% endblock %}
